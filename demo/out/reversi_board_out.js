var f=null,i=this;function k(a,c){var b=a.split("."),d=i;!(b[0]in d)&&d.execScript&&d.execScript("var "+b[0]);for(var e;b.length&&(e=b.shift());)!b.length&&void 0!==c?d[e]=c:d=d[e]?d[e]:d[e]={}}function l(a,c){function b(){}b.prototype=c.prototype;a.u=c.prototype;a.prototype=new b};function m(a){return"undefined"!=typeof a&&a!=f}function n(a,c){for(var b=1;b<arguments.length;++b)if(m(a.match("%s")))a=a.replace(/%s/,arguments[b]);else throw Error("Too many positional arguments to fill format string: "+a);if(m(a.match("%s")))throw Error("Not enough positional arguments to fill in format string: "+a);return a};function o(){}function p(a){this.d=a||f}p.prototype.h=function(a){this.d=a||f};function q(a,c){this.a=[];for(var b=0;b<c;++b){this.a[b]=[];for(var d=0;d<a;++d)this.a[b][d]=new p(f)}}function r(a,c){if(0>c[0]||a.a.length<=c[0]||0>c[1]||a.a[0].length<=c[1])throw Error(n("Invalid coords (%s, %s) for board (%s x %s)",c[0],c[1],a.a.length,a.a[0].length));return a.a[c[0]][c[1]]}q.prototype.l=function(a){a=s(a);r(this,a).h(f)};k("gamebuilder.games.BoardMxN.prototype.erasePieceAtPos",q.prototype.l);
q.prototype.b=function(a){return r(this,a).d};function s(a){if(2>a.length)throw Error("Invalid format of coordinates: "+a);return[a.charCodeAt(0)-97,a.substr(1,a.length)-1]};function t(a){this.k=a}var u=new t("white"),v=new t("black");function w(a){this.k=a}l(w,o);w.prototype.color=function(){return this.k};function x(){this.d=f}x.prototype.h=function(a){this.d=a||f};function y(a,c){q.call(this,a,c);this.a=[];for(var b=0;b<c;++b){this.a[b]=[];for(var d=0;d<a;++d)this.a[b][d]=new x}}l(y,q);y.prototype.o=function(a,c){var b=new w(a),d=s(c);r(this,d).h(b)};k("gamebuilder.games.go.BoardMxN.prototype.setPieceColorAtPos",y.prototype.o);
y.prototype.b=function(a){a=r(this,a).d;return m(a)?a:f};k("gamebuilder.games.go.BoardMxN.prototype.getPieceAtCoords",y.prototype.b);y.prototype.q=function(a){return this.b(s(a))};k("gamebuilder.games.go.BoardMxN.prototype.getPieceAtPos",y.prototype.q);function z(a){y.call(this,a,a)}l(z,y);var A=t;function B(){z.call(this,8)}l(B,z);var C=new function(){this.t="reversi-holder";this.s=this.r="reversi"};function D(a){this.a=a;this.m=document.createElement("table");this.g=document.createElement("table");this.f=!1;this.c="";this.i=C}D.prototype.n=function(a){this.c=a};k("gamebuilder.games.reversi.ui.BoardUI.prototype.setImagePath",D.prototype.n);D.prototype.e=function(a){if(m(a)){if(a.color()==v)return n("%s/black.png",this.c);if(a.color()==u)return n("%s/white.png",this.c);throw Error("Invalid color of piece: "+a.color());}return n("%s/clear.png",this.c)};
k("gamebuilder.games.reversi.ui.BoardUI.prototype.imagePathForPiece",D.prototype.e);function E(a,c){var b=document.createElement("img");b.src=a.e(c);b.style.width=b.style.height="50px";return b}function F(a,c){if(!a.f)throw Error("Error: must call reversi.ui.BoardUI.init() prior to calling reversi.ui.BoardUI."+c+"()");}
function G(a){if(!a.f&&!a.f){if(""==a.c)throw Error("Error: call reversi.ui.BoardUI.setImagePath() prior to calling reversi.ui.BoardUI.init()");var c=a.a,b=a.m,d=a.g;b.className=a.i.t;d.className=a.i.r;var e=document.createElement("tr"),g=document.createElement("td");b.appendChild(e);e.appendChild(g);g.appendChild(d);b.cellSpacing=d.cellSpacing=0;b.cellPadding=d.cellPadding=0;b=c.a[0].length;for(e=c.a.length-1;0<=e;--e)for(var g=d.insertRow(-1),j=0;j<b;++j){var h=document.createElement("td");h.className=
a.i.s;h.appendChild(E(a,c.b([j,e])));g.appendChild(h)}a.f=!0}return a.m}function H(a,c){return[c[1],a.a.a.length-c[0]-1]}D.prototype.update=function(){F(this,"update");for(var a=this.a,c=this.g,b=0;b<c.rows.length;++b)for(var d=c.rows[b],e=0;e<d.childNodes.length;++e){var g=d.childNodes[e].childNodes[0],j=a.b(H(this,[b,e]));if(g.src!=this.e(j))g.src=this.e(j)}};function I(a,c,b){var d=J;return function(){d(a,c,b)}};var K=A.j,L=[[A.j,"blackPiece"],[A.p,"whitePiece"],[f,"emptyPiece"]];function M(){for(var a=0;a<L.length;++a)document.getElementById(L[a][1]).className=K==L[a][0]?"sel":"notsel"}function J(a,c,b){m(K)?c.o(K,b):c.l(b);a.update();M()}function N(a){return function(){K=a;M()}}function O(a){a=String.fromCharCode(a.which).toLowerCase();"b"==a?K=A.j:"w"==a?K=A.p:"e"==a&&(K=f);M()}
k("demo.reversi.board.displayReversiBoard",function(){var a=new B,a=new D(a);a.n("../data/images/go");document.getElementById("board").appendChild(G(a));for(var c=0;c<L.length;++c){var b=L[c][0],d=f;m(b)&&(d=new w(b));d=E(a,d);d.onclick=N(b);document.getElementById(L[c][1]).appendChild(d)}a.update();F(a,"bindEmptyCells");c=a.a;b=a.g;for(d=0;d<b.rows.length;++d)for(var e=b.rows[d],g=0;g<e.childNodes.length;++g){var j=e.childNodes[g].childNodes[0],h=H(a,[d,g]),P=n("%s%s",String.fromCharCode(97+h[0]),
h[1]+1),h=c.b(h);if("undefined"==typeof h||h==f)j.onclick=I(a,c,P)}M();document.onkeypress=O});
