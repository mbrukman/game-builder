var i=null,j=this;function k(a,c){var b=a.split("."),d=j;!(b[0]in d)&&d.execScript&&d.execScript("var "+b[0]);for(var e;b.length&&(e=b.shift());)!b.length&&void 0!==c?d[e]=c:d=d[e]?d[e]:d[e]={}}function l(a,c){function b(){}b.prototype=c.prototype;a.m=c.prototype;a.prototype=new b};function m(a){return"undefined"!=typeof a&&a!=i}function n(a,c){for(var b=1;b<arguments.length;++b)if(m(a.match("%s")))a=a.replace(/%s/,arguments[b]);else throw Error("Too many positional arguments to fill format string: "+a);if(m(a.match("%s")))throw Error("Not enough positional arguments to fill in format string: "+a);return a};function o(a){this.b=a}o.prototype.color=function(){return this.b};function p(a,c){this.a=[];for(var b=0;b<c;++b){this.a[b]=[];for(var d=0;d<a;++d)this.a[b][d]=i}}function q(a,c,b){if(2>b.length)throw Error("Invalid format of coordinates: "+b);b=[b.charCodeAt(0)-97,b.substr(1,b.length)-1];r(a,b);a.a[b[0]][b[1]]=c}function r(a,c){if(0>c[0]||a.a.length<=c[0]||0>c[1]||a.a[0].length<=c[1])throw Error(n("Invalid coords (%s, %s) for board (%s x %s)",c[0],c[1],a.a.length,a.a[0].length));}
function s(a,c){r(a,c);return a.a[c[0]][c[1]]}function t(a){p.call(this,a,a)}l(t,p);function u(a){this.b=a}var v=new u("white"),w=new u("black");function x(a){this.b=this.b=a}l(x,o);x.prototype.color=function(){return this.b};function y(){t.call(this,8)}l(y,t);var z=new function(){this.l="reversi-holder";this.k=this.j="reversi"};function A(a){this.a=a;this.h=document.createElement("table");this.f=document.createElement("table");this.e=!1;this.c="";this.g=z}A.prototype.i=function(a){this.c=a};k("gamebuilder.games.reversi.ui.BoardUI.prototype.setImagePath",A.prototype.i);A.prototype.d=function(a){if(m(a)){if(a.color()==w)return n("%s/black.png",this.c);if(a.color()==v)return n("%s/white.png",this.c);throw Error("Invalid color of piece: "+a.color());}return n("%s/clear.png",this.c)};
k("gamebuilder.games.reversi.ui.BoardUI.prototype.imagePathForPiece",A.prototype.d);function B(a,c){var b=document.createElement("img");b.src=a.d(c);b.style.width=b.style.height="50px";return b}function C(a,c){if(!a.e)throw Error("Error: must call reversi.ui.BoardUI.init() prior to calling reversi.ui.BoardUI."+c+"()");}
function D(a){if(!a.e&&!a.e){if(""==a.c)throw Error("Error: call reversi.ui.BoardUI.setImagePath() prior to calling reversi.ui.BoardUI.init()");var c=a.a,b=a.h,d=a.f;b.className=a.g.l;d.className=a.g.j;var e=document.createElement("tr"),f=document.createElement("td");b.appendChild(e);e.appendChild(f);f.appendChild(d);b.cellSpacing=d.cellSpacing=0;b.cellPadding=d.cellPadding=0;b=c.a[0].length;for(e=c.a.length-1;0<=e;--e)for(var f=d.insertRow(-1),h=0;h<b;++h){var g=document.createElement("td");g.className=
a.g.k;g.appendChild(B(a,s(c,[h,e])));f.appendChild(g)}a.e=!0}return a.h}function E(a,c){return[c[1],a.a.a.length-c[0]-1]}A.prototype.update=function(){C(this,"update");for(var a=this.a,c=this.f,b=0;b<c.rows.length;++b)for(var d=c.rows[b],e=0;e<d.childNodes.length;++e){var f=d.childNodes[e].childNodes[0],h=s(a,E(this,[b,e]));if(f.src!=this.d(h))f.src=this.d(h)}};function F(a,c,b){var d=G;return function(){d(a,c,b)}};var H=w,I=[[w,"blackPiece"],[v,"whitePiece"],[i,"emptyPiece"]];function J(){for(var a=0;a<I.length;++a)document.getElementById(I[a][1]).className=H==I[a][0]?"sel":"notsel"}function G(a,c,b){m(H)?q(c,new x(H),b):q(c,i,b);a.update();J()}function K(a){return function(){H=a;J()}}function L(a){a=String.fromCharCode(a.which).toLowerCase();"b"==a?H=w:"w"==a?H=v:"e"==a&&(H=i);J()}
k("demo.reversi.board.displayReversiBoard",function(){var a=new y,a=new A(a);a.i("../data/images/go");document.getElementById("board").appendChild(D(a));for(var c=0;c<I.length;++c){var b=I[c][0],d=i;m(b)&&(d=new x(b));d=B(a,d);d.onclick=K(b);document.getElementById(I[c][1]).appendChild(d)}a.update();C(a,"bindEmptyCells");c=a.a;b=a.f;for(d=0;d<b.rows.length;++d)for(var e=b.rows[d],f=0;f<e.childNodes.length;++f){var h=e.childNodes[f].childNodes[0],g=E(a,[d,f]),M=n("%s%s",String.fromCharCode(97+g[0]),
g[1]+1),g=s(c,g);if("undefined"==typeof g||g==i)h.onclick=F(a,c,M)}J();document.onkeypress=L});
